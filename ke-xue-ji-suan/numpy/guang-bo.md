### 广播 {#broadcasting}

广播是一种强大的机制，允许numpy在执行算术运算时使用不同形状的数组。经常有一个较小的数组和一个较大的数组，希望多次使用较小的数组来对较大的数组执行某些操作

```
# -*- coding: utf-8 -*-
"""
Created on Thu Oct 18 13:53:59 2018

@author: tokimeki
"""

import numpy as np

x = np.array([
        [1,2,3],
        [4,5,6],
        [7,8,9],
        [10,11,12],
        ])

v = np.array([1,0,1])

# 创建一个与x形状相同的空矩阵
y = np.empty_like(x)

print(y)
# [[0 0 0]
# [0 0 0]
# [0 0 0]
# [0 0 0]]

# 但是当矩阵x非常大时，在Python中计算显式循环可能会很慢
for i in range(4):
    y[i,:] = x[i,:] + v

print(y)
# [[ 2  2  4]
# [ 5  5  7]
# [ 8  8 10]
# [11 11 13]]
```

将向量添加v到矩阵的每一行 x等同于vv通过堆叠多个v垂直副本来形成矩阵，然后执行和的元素x和求和vv。可以像这样实现这种方法：

```
x1 = np.array([
        [1,2,3],
        [4,5,6],
        [7,8,9],
        [10,11,12],
        ])

v1= np.array([1,0,1])

# 将v1的4个副本叠加在一起
vv = np.tile(v1,(4,1))
print(vv)
# [[1 0 1]
# [1 0 1]
# [1 0 1]
# [1 0 1]]

y1 = x1 + vv # 元素添加x1和vv
print(y)
# [[ 2  2  4
# [ 5  5  7]
# [ 8  8 10]
# [11 11 13]]
```

Numpy广播允许我们执行此计算而无需实际创建多个副本v。考虑这个版本，使用广播：

```
x2 = np.array([
        [1,2,3],
        [4,5,6],
        [7,8,9],
        [10,11,12],
        ])

v2= np.array([1,0,1])

y2 = x2+v2
print(y2)
# [[ 2  2  4
# [ 5  5  7]
# [ 8  8 10]
# [11 11 13]]
```






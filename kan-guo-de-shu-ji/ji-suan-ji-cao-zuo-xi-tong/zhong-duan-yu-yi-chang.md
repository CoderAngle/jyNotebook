* 中断机制的诞生
  * 系统资源利用率低
    * 为了解决上述问题，引入中断机制，实现了多道程序并发执行
    * 本质:发生中断就意味着需要操作系统介入，开展管理工作
* 中断的概念和作用
  * 当中断发生时，cpu立即进入核心态
  * 当中断发生后，当前运行的进程暂停运行，并由操作系统内核对中断进行处理
  * 对于不同的中断信号，会进行不同的处理

```
有了中断，才能实现多道程序并发执行

问题:用户态、和心态之间的切换是怎么实现的?

答:"用户态->核心态"是通过中断实现的，并且中断是唯一路径。
"核心态->用户态"的切换是通过执行一个特权指令，将程序状态字(PSW)的标志位设置为"用户态"
```

* 中断的分类-广义的中断

  * 内中断\(也称为"异常"、"例外"、"陷入"\)

    * 信号来源:CPU内部与当前执行的指令有关

    * 自愿中断-指令中断

      * 如:系统调用时使用的访管指令\(又叫陷入指令，trap指令\)

    * 强迫指令

      * 硬件故障
        * 如:缺页
      * 软件中断
        * 如:整数除0

  * 外中断-狭义的中断

    * 信号来源:CPU外部与当前执行的指令无关
    * 外设请求
      * 如:I/O操作完成发出的中断信号
    * 人工干预
      * 如:用户强行终止一个进程

---

另外一种分类方式:

* 中断分类
  * 内中断\(内部异常\)
    * 信号来源:CPU内部
    * 陷进、陷入\(trap\):有意而为之的异常，如系统调用
    * 故障\(fault\)
      * 由错误条件引起的，可能被故障处理程序修复，如缺页
    * 终止\(abort\)
      * 不可恢复的致命错误造成的结果，终止处理程序不再将控制返回给引发终止的应用程序，如整数除0
  * 外中断
    * 信号来源:CPU外部
    * I/O中断请求
    * 人工干预

---

* 外中断的处理过程

  * 执行完每个指令之后，cpu都要检查当前是否有外部中断信号

  * 如果检测到外部中断信号，则需要保护被中断进程的cpu环境\(如程序状态字PSW、程序计数器PC、各种通用寄存器\)

  * 根据中断信号类型转入相应的中断处理程序

  * 恢复原进程的cpu环境并退出中断，返回原进程继续往下执行

![](/assets/js-14.3.4-2.png)

* 通过"中断信号来cpu内部还是外部"判断内/外中断



